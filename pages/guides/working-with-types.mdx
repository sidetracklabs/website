import { Callout } from "nextra/components";

# Working with Types

Typing the queues and handlers will help prevent you from misusing Sidetrack, like inserting a job on a nonexistent queue, or inserting a job with an invalid payload. Types can improve your developer experience.

To get started, pass your type generic to Sidetrack. The generic is an object with keys that match your queue names, and values that are the type of the payload for that queue. For example, if you have a queue called userOnboarding, and the payload is an object with an email property, you can type your queues like this:

```ts twoslash
// @noErrors
new Sidetrack<
  userOnboarding: { email: string };
>(
  /* excluding for brevity */
);
```

Notice the type generic passed above. Here is the full example:

```twoslash include main
import { Sidetrack } from "sidetrack";

const sidetrack = new Sidetrack<{
  userOnboarding: { email: string };
}>({
  databaseOptions: {
    connectionString: process.env["DATABASE_URL"]!,
  },
  queues: {
    userOnboarding: {
      handler: async (job) => {
        console.log(`Welcome ${job.payload.email}`);
      },
    },
  },
});
```
Notice how the handler function receives a job. This job contains a `payload` key which will be typed to match your payload types above. The job also contains other fields you can use in your handler function (e.g. the job's id, scheduledAt, status, currentAttempt, etc.)

## Avoiding errors

You can insert a job on only the userOnboarding queue. Notice the type error if I try inserting on a queue that doesn't exist.

```ts twoslash
// @include: main
// ---cut---
// @errors: 2345
sidetrack.insertJob("reports", { email: "a@example.com"})
```

Types also prevent you from inserting a job with incorrect payload. Notice I must pass a email of type string.

```ts twoslash
// @include: main
// ---cut---
// @errors: 2345
sidetrack.insertJob("userOnboarding", { phone: "11111111111" });
```


The type of your payload must only use JSON seriazable values, since the job payload will be persisted in the DB as JSONB.